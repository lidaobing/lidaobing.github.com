---
layout: post
name: debian-vpn-server-root-apt-get-install_01
title: "Debian 下 VPN Server 架设手记"
date: 2005-06-01 21:22:00.000000000 +08:00
categories: []
permalink: /2005/06/debian-vpn-server-root-apt-get-install_01.html
---
<p> 以下步骤均假定你在root用户下运行  </p>   <ol> <li>安装必要软件 <pre>apt-get install pptpd kernel-tree-2.6.10 kernel-package<br />apt-get install kernel-patch-mppe libc6-dev<br /></pre> </li><li>解压Linux kernel <pre>cd /usr/src<br />tar xjf kernel-source-2.6.10.tar.bz2<br /></pre> </li><li>配置内核<br />   我图简单，直接拷贝了一份现有的config文件 <pre>cd /usr/src/kernel-source-2.6.10<br />cp /boot/config-2.6.10-1-686-smp .config<br /></pre> </li><li>编译内核 <pre>make-kpkg --added-patches debian,mppe --append-to-version -686-smp-mppe --initrd kernel_image<br /></pre> 然后去喝茶 </li><li>安装新内核，重启 <pre>cd /usr/src/<br />dpkg -i kernel-image-2.6.10-686-smp-mppe_10.00.Custom_i386.deb<br />update-grub<br />reboot<br /></pre> </li><li>配置pptpd <pre>vi /etc/pptpd.conf<br /></pre> 修改localip和remoteip, localip改成服务器的IP, remoteip是供登录上来的机器使用的IP，如 <pre>localip 1.2.3.4<br />remoteip 1.2.3.50-70<br /></pre> </li><li>配置chap-secrets <pre>vi /etc/ppp/chap-secrets<br /></pre> 如果不限制ip，可以改成如下的样子 <pre>username pptpd password *<br /></pre> 如果限制IP，可以改成 <pre>username pptpd password 162.105.0.0/16 166.111.0.0/16<br /></pre> </li><li>配置network <pre>/etc/network/options<br /></pre> 修改ip_forward选项 <pre>ip_forward=yes<br /></pre> </li><li>重启network和pptpd <pre>/etc/init.d/networking restart<br />/etc/init.d/pptpd restart<br /></pre> </li><li>测试<br />运气好就应该可以了，测试时可以通过 <tt> tail -f /var/log/syslog </tt> 来监视 </li><li>后记<br />曾经在AMD64-K8-SMP的机器上进行这一套程序，结果一旦有人试图链接，就 Kernel Panic, 失败。 </li><li>THANKS </li> </ol>   <ul> <li><tt>fjdc AT 163 DOT com</tt> </li> </ul><div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/6324560-111763214350504898?l=lidaobing.blogspot.com' alt='' /></div>
