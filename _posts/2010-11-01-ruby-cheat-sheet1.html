---
layout: post
name: ruby-cheat-sheet1
title: Ruby Cheat Sheet#1 反射
date: 2010-11-01 23:20:00.000000000 +08:00
permalink: /2010/11/ruby-cheat-sheet1.html
tags: ruby
---
<pre><br /><br />irb(main):001:0&gt; a = Object.new<br />=&gt; #&lt;Object:0x7ff7a6ff6388&gt;<br />irb(main):002:0&gt; a.object_id #获取对象ID<br />=&gt; 70350817702340<br />irb(main):003:0&gt; a.class #获取对象类型<br />=&gt; Object<br />irb(main):004:0&gt; Integer.superclass #获取父类<br />=&gt; Numeric<br />irb(main):006:0&gt; Numeric.superclass #...<br />=&gt; Object<br />irb(main):007:0&gt; Object.superclass #Object父类为 nil<br />=&gt; nil<br />irb(main):011:0&gt; Integer.ancestors #获取类的父类及 include 的类<br />=&gt; [Integer, Precision, Numeric, Comparable, Object, Kernel]<br />irb(main):013:0&gt; Integer.class #类的类型是 Class<br />=&gt; Class<br />irb(main):019:0&gt; 1.methods #查找对象的方法<br />=&gt; ["%", ...]<br />irb(main):020:0&gt; 1.public_methods #查找对象的公开方法<br />irb(main):022:0&gt; 1.protected_methods #查找对象的保护方法<br />irb(main):023:0&gt; 1.private_methods #查找对象的私有方法<br /><br />irb(main):029:0&gt; class &lt;&lt; a<br />irb(main):030:1&gt; def foo; end<br />irb(main):031:1&gt; end<br />=&gt; nil<br />irb(main):032:0&gt; a.singleton_methods #查找对象的单例方法<br />=&gt; ["foo"]<br /><br />irb(main):033:0&gt; a.methods.grep /methods/ #快速查询方法<br />=&gt; ["public_methods", "methods", "singleton_methods", "protected_methods", "private_methods"]<br /><br />irb(main):034:0&gt; Integer.methods #类也是对象，也有 :methods<br />=&gt; ["private_class_method", ...]<br />irb(main):036:0&gt; Integer.instance_methods             #获取实例方法<br />irb(main):037:0&gt; Integer.public_instance_methods      #...<br />irb(main):038:0&gt; Integer.protected_instance_methods   #...<br />irb(main):039:0&gt; Integer.private_instance_methods     #...<br /><br />irb(main):041:0&gt; 1.method :times #获取方法对象<br />=&gt; #&lt;Method: Fixnum(Integer)#times&gt;<br />irb(main):042:0&gt; 1.method(:times).call #执行方法对象<br />=&gt; #&lt;Enumerable::Enumerator:0x7ff7a703fb78&gt;<br />irb(main):044:0&gt; 1.send :times #执行方法对象<br />=&gt; #&lt;Enumerable::Enumerator:0x7ff7a7019090&gt;<br />irb(main):045:0&gt; 1.__send__ :times #执行方法对象<br />=&gt; #&lt;Enumerable::Enumerator:0x7ff7a6ffd1b0&gt;<br /><br />irb(main):047:0&gt; m = 1.method :times<br />=&gt; #&lt;Method: Fixnum(Integer)#times&gt;<br />irb(main):048:0&gt; m.name #方法名称<br />=&gt; "times"<br />irb(main):051:0&gt; m.owner #方法所在的类<br />=&gt; Integer<br />irb(main):054:0&gt; m.to_proc #转成 Proc 对象<br />=&gt; #&lt;Proc:0x00007ff7a6f955d8@(irb):54&gt;<br />irb(main):055:0&gt; m.unbind #解除绑定<br />=&gt; #&lt;UnboundMethod: Fixnum(Integer)#times&gt;<br />irb(main):056:0&gt; m.arity #最少参数个数<br />=&gt; 0<br />irb(main):057:0&gt; m.receiver #绑定的对象<br />=&gt; 1<br /><br />irb(main):058:0&gt; m = Integer.instance_method :times #获取未绑定的对象<br />=&gt; #&lt;UnboundMethod: Integer#times&gt;<br />irb(main):060:0&gt; m.bind(1) #绑定<br />=&gt; #&lt;Method: Fixnum(Integer)#times&gt;<br />irb(main):061:0&gt; m.owner #方法所在的类<br />=&gt; Integer<br />irb(main):062:0&gt; m.arity #最少参数个数<br />=&gt; 0<br />irb(main):063:0&gt; m.bind(Object.new) #绑定时会做类型检查<br />TypeError: bind argument must be an instance of Integer<br /> from (irb):63:in `bind'<br /> from (irb):63<br /> from :0<br />irb(main):075:0&gt; Integer.method_defined? :times #查询类的实例方法是否被定义<br />=&gt; true<br />irb(main):076:0&gt; Integer.public_method_defined? :times<br />=&gt; true<br />irb(main):077:0&gt; Integer.protected_method_defined? :times<br />=&gt; false<br />irb(main):078:0&gt; Integer.private_method_defined? :times<br />=&gt; false<br /><br />irb(main):089:0&gt; 1.respond_to? :times #检查对象是否有方法<br />=&gt; true<br />irb(main):092:0&gt; 1.respond_to? :raise<br />=&gt; false<br />irb(main):093:0&gt; 1.respond_to? :raise, true #同时检查私有方法<br />=&gt; true<br />irb(main):106:0&gt; [1.class, 1.class.superclass]<br />=&gt; [Fixnum, Integer]<br />irb(main):098:0&gt; 1.is_a? Fixnum #检查1是否是 Fixnum 或其子类的对象<br />=&gt; true<br />irb(main):099:0&gt; 1.is_a? Integer #检查1是否是 Integer 或其子类的对象<br />=&gt; true<br />irb(main):103:0&gt; 1.instance_of? Fixnum #检查1是否是 Fixnum 的对象<br />=&gt; true<br />irb(main):104:0&gt; 1.instance_of? Integer #检查1是否是 Integer 的对象<br />=&gt; false<br />irb(main):108:0&gt; Fixnum.instance_methods - Integer.instance_methods #查看 Fixnum 类新添加的实例方法<br />=&gt; ["%", "&lt;&lt;", "&amp;", "&gt;&gt;", "to_sym", "*", "+", "-", "/", "|", "size", "~", "^", "**", "to_f", "id2name", "[]"]<br /></pre><br />补1: 刚才忘了变量部分了<br /><pre><br />irb(main):001:0&gt; class A<br />irb(main):002:1&gt;   @@b = 1<br />irb(main):003:1&gt;   @c = 2<br />irb(main):004:1&gt;   def initialize<br />irb(main):005:2&gt;     @d = 3<br />irb(main):006:2&gt;   end<br />irb(main):007:1&gt; end<br />=&gt; nil<br />irb(main):008:0&gt; A.class_variables<br />=&gt; ["@@b"]<br />irb(main):010:0&gt; A.class_variable_defined? "@@b"<br />=&gt; true<br />irb(main):011:0&gt; A.instance_variables<br />=&gt; ["@c"]<br />irb(main):012:0&gt; A.instance_variable_defined? "@c"<br />=&gt; true<br />irb(main):014:0&gt; A.instance_variable_set "@c", 15<br />=&gt; 15<br />irb(main):015:0&gt; A.instance_variable_get "@c"<br />=&gt; 15<br />irb(main):016:0&gt; a = A.new<br />=&gt; #&lt;A:0x7f55a5717c88 @d=3&gt;<br />irb(main):018:0&gt; a.instance_variables<br />=&gt; ["@d"]<br />irb(main):019:0&gt; a.instance_variable_defined? "@d"<br />=&gt; true<br />irb(main):020:0&gt; a.instance_variable_set "@d", 16<br />=&gt; 16<br />irb(main):021:0&gt; a.instance_variable_get "@d"<br />=&gt; 16<br /></pre><div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/6324560-341719142858147324?l=lidaobing.blogspot.com' alt='' /></div>
