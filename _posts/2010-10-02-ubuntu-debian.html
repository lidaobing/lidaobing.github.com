---
layout: post
name: ubuntu-debian
title: 在 Ubuntu 构建 Debian 打包环境
date: 2010-10-02 18:44:00.000000000 +08:00
categories:
- packaging
- debian
- ubuntu
permalink: /2010/10/ubuntu-debian.html
---
0. 原因<br />尽管你是在 Ubuntu 下工作，但由于种种原因[1]，你还是需要给 Debian 做打包工作，如果你不想你做的包因为一些简单的错误被退回，比如无法在 Debian 下编译，没有处理好 lintian 警告，那么最好在 Ubuntu 下给 Debian 打包的环境，步骤如下所示：<br /> <br />1. 安装 approx<br />打包时经常需要反复下载一些包, 如果你的网速不够快，建议安装 approx 透明代理, 可以缓存大部分包。安装方法: "sudo apt-get install approx", 然后修改配置文件 /etc/approx/approx.conf 为<br />ubuntu http://cn.archive.ubuntu.com/ubuntu<br />debian http://mirrors.163.com/debian<br /> <br />2. 修改 /etc/apt/sources.list, 修改为如下的内容<br />deb http://127.0.0.1:9999/ubuntu lucid main restricted universe multiverse<br />deb http://127.0.0.1:9999/ubuntu lucid-security main restricted universe multiverse<br />deb http://127.0.0.1:9999/ubuntu lucid-updates main restricted universe multiverse<br /> <br />3. 安装工具包, 运行 "sudo apt-get install ubuntu-dev-tools cowbuilder"<br /> <br />4. 准备 cowbuilder-sid<br />$ sudo cp /usr/bin/pbuilder-dist /usr/bin/cowbuilder-sid<br />$ sudo sed -ie 's,ftp://ftp.debian.org/debian,http://127.0.0.1:9999/debian,' /usr/bin/cowbuilder-sid<br /> <br />5. 准备开发环境<br />$ sudo mkdir /var/cache/pbuilder-dist/sid_result<br />$ cowbuilder-sid create<br /> <br />6. 开始开发<br />$ dget http://ftp.debian.org/debian/pool/main/h/hello/hello_2.6-1.dsc<br />$ dpkg-source -x hello_2.6-1.dsc<br />$ cd hello-2.6<br />$ # 修改 debian 包，版本改为 2.6-2<br />$ debuild -S -sa<br />$ cd ..<br />$ cowbuilder-sid hello_2.6-2.dsc # 使用 sid 环境进行编译<br /> <br />7. 检查<br />7.1 安装最新版的 lintian<br />Ubuntu 自带的 lintian 版本不够新，需要从 Debian 安装最新版本<br />$ # 到 http://ftp.us.debian.org/debian/pool/main/l/lintian/ 下载最新版本的 lintian <br />$ wget http://ftp.us.debian.org/debian/pool/main/l/lintian/lintian_2.4.3_all.deb<br />$ sudo dpkg -i lintian_2.4.3_all.deb<br />$ sudo apt-get -f install<br /> <br />7.2 对包做最后的检查<br />$ cd /var/cache/pbuilder-dist/sid_result<br />$ lintian -i hello_2.6-2_amd64.changes<br />$ #如果上一步出现错误，则继续修正<br />$ debsign hello_2.6-2_amd64.changes #签名<br /> <br />8. 上传<br />根据 http://mentors.debian.net/cgi-bin/maintainer-intro 的介绍准备好 mentors.debian.net 的上传的环境, 然后用如下的命令上传<br />$ dput mentors hello_2.6-2_amd64.changes<br /> <br />9. 召唤 Debian Developer (DD)<br />到 mentors.debian.net, 登录后可以找到一份模板邮件, 把模板邮件中的内容填好，然后发到 debian-mentors@lists.debian.org <br />如果你有相熟的 DD, 也可以直接发信给他让他帮忙检查。<div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/6324560-6922254191969014109?l=lidaobing.blogspot.com' alt='' /></div>
